# ğŸš€ Kafka ê¸°ë°˜ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

> Spring Boot + Apache Kafkaë¥¼ í™œìš©í•œ í™•ì¥ ê°€ëŠ¥í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì‹œìŠ¤í…œ

[![Java](https://img.shields.io/badge/Java-21-007396?style=flat&logo=java)](https://openjdk.java.net/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.5-6DB33F?style=flat&logo=spring-boot)](https://spring.io/projects/spring-boot)
[![Kafka](https://img.shields.io/badge/Apache%20Kafka-Latest-231F20?style=flat&logo=apache-kafka)](https://kafka.apache.org/)
[![Gradle](https://img.shields.io/badge/Gradle-8.x-02303A?style=flat&logo=gradle)](https://gradle.org/)

## ğŸ“‹ ëª©ì°¨
- [í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
- [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
- [í•µì‹¬ ê¸°ëŠ¥](#-í•µì‹¬-ê¸°ëŠ¥)
- [ì„œë¹„ìŠ¤ êµ¬ì„±](#-ì„œë¹„ìŠ¤-êµ¬ì„±)
- [API ëª…ì„¸](#-api-ëª…ì„¸)
- [ì‹¤í–‰ ë°©ë²•](#-ì‹¤í–‰-ë°©ë²•)
- [ê¸°ìˆ ì  êµ¬í˜„ í¬ì¸íŠ¸](#-ê¸°ìˆ ì -êµ¬í˜„-í¬ì¸íŠ¸)

---

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” **Apache Kafkaë¥¼ í™œìš©í•œ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜**ë¥¼ êµ¬í˜„í•œ í•™ìŠµ ë° ì‹¤ìŠµìš© ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•
- âœ… **ëŠìŠ¨í•œ ê²°í•©(Loose Coupling)**: ì„œë¹„ìŠ¤ ê°„ ë…ë¦½ì„± ë³´ì¥
- âœ… **ë¹„ë™ê¸° ë©”ì‹œì§•**: Kafkaë¥¼ í†µí•œ íš¨ìœ¨ì ì¸ ì´ë²¤íŠ¸ ì²˜ë¦¬
- âœ… **í™•ì¥ì„±**: ê° ì„œë¹„ìŠ¤ì˜ ë…ë¦½ì ì¸ ìŠ¤ì¼€ì¼ë§ ê°€ëŠ¥
- âœ… **ì¥ì•  í—ˆìš©ì„±**: DLT(Dead Letter Topic) ë° ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜
- âœ… **ì‹¤ì‹œê°„ ì²˜ë¦¬**: ì´ë²¤íŠ¸ ê¸°ë°˜ ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬

### ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œë‚˜ë¦¬ì˜¤
1. **ì‚¬ìš©ì íšŒì›ê°€ì… í”Œë¡œìš°**: ì‚¬ìš©ì ë“±ë¡ ì‹œ í™˜ì˜ ì´ë©”ì¼ ìë™ ë°œì†¡
2. **ì´ë©”ì¼ ë°œì†¡ ì‹œìŠ¤í…œ**: REST APIë¥¼ í†µí•œ ë¹„ë™ê¸° ì´ë©”ì¼ ì „ì†¡

---

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤ï¿½ecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Client (REST API)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                              â”‚
                 â”‚                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  User Service   â”‚          â”‚ Email-Send-Producer â”‚
        â”‚   (Port 8080)   â”‚          â”‚                     â”‚
        â”‚                 â”‚          â”‚                     â”‚
        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚ â”‚ POST /users â”‚ â”‚          â”‚ â”‚ POST /emails    â”‚ â”‚
        â”‚ â”‚  (íšŒì›ê°€ì…)   â”‚ â”‚          â”‚ â”‚  (ì´ë©”ì¼ ë°œì†¡)    â”‚ â”‚
        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                              â”‚
                 â”‚ Publish Event                â”‚ Publish Event
                 â”‚                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            Apache Kafka Cluster                  â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ user.signed-up   â”‚   â”‚   email.send        â”‚ â”‚
        â”‚  â”‚     Topic        â”‚   â”‚     Topic           â”‚ â”‚
        â”‚  â”‚  (3 partitions)  â”‚   â”‚  (3 partitions)     â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                  â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚  DLT Topics (ì¥ì•  ë©”ì‹œì§€ ì²˜ë¦¬)            â”‚   â”‚
        â”‚  â”‚  - user.signed-up.dlt                    â”‚   â”‚
        â”‚  â”‚  - email.send.dlt                        â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                          â”‚
                 â”‚ Subscribe                â”‚ Subscribe
                 â”‚                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Email Service  â”‚        â”‚ Email-Send-Consumer â”‚
        â”‚   (Port 8081)   â”‚        â”‚   (Random Port)     â”‚
        â”‚                 â”‚        â”‚                     â”‚
        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚ â”‚  Consumer   â”‚ â”‚        â”‚ â”‚    Consumer     â”‚ â”‚
        â”‚ â”‚ + DB ì €ì¥   â”‚ â”‚        â”‚ â”‚  ì´ë©”ì¼ ë°œì†¡ ë¡œì§ â”‚ â”‚
        â”‚ â”‚ (H2 emailDB)â”‚ â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° í”Œë¡œìš°
```
1ï¸âƒ£ íšŒì›ê°€ì… ì‹œë‚˜ë¦¬ì˜¤
   Client â†’ User Service â†’ Kafka (user.signed-up) â†’ Email Service â†’ DB ì €ì¥ + ì´ë©”ì¼ ë°œì†¡

2ï¸âƒ£ ì´ë©”ì¼ ë°œì†¡ ì‹œë‚˜ë¦¬ì˜¤
   Client â†’ Email-Send-Producer â†’ Kafka (email.send) â†’ Email-Send-Consumer â†’ ì´ë©”ì¼ ë°œì†¡
```

---

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

### Backend Framework
- **Java 21** - ìµœì‹  LTS ë²„ì „
- **Spring Boot 3.5.5** - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë ˆì„ì›Œí¬
- **Spring Web** - RESTful API êµ¬í˜„
- **Spring Data JPA** - ORM ë° ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™
- **Spring Kafka** - Kafka í†µí•©

### Messaging & Event Streaming
- **Apache Kafka** - ë¶„ì‚° ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° í”Œë«í¼
  - ë©€í‹° íŒŒí‹°ì…˜ ì„¤ì • (3ê°œ)
  - Round Robin Partitioner
  - Consumer Group ê¸°ë°˜ ë³‘ë ¬ ì²˜ë¦¬

### Database
- **H2 Database** - ì¸ë©”ëª¨ë¦¬ ë°ì´í„°ë² ì´ìŠ¤
  - userDB (User Service)
  - emailDB (Email Service)

### Build Tool
- **Gradle 8.x** - ì˜ì¡´ì„± ê´€ë¦¬ ë° ë¹Œë“œ ìë™í™”

---

## âš¡ í•µì‹¬ ê¸°ëŠ¥

### 1. ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜
- **ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬**: Kafkaë¥¼ í†µí•œ ì„œë¹„ìŠ¤ ê°„ ëŠìŠ¨í•œ ê²°í•©
- **ì´ë²¤íŠ¸ ë°œí–‰/êµ¬ë… íŒ¨í„´**: Producer-Consumer ëª¨ë¸ êµ¬í˜„

### 2. ì¥ì•  ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜
```java
@RetryableTopic(
    attempts = "5",                           // ì´ 5íšŒ ì‹œë„
    backoff = @Backoff(delay = 1000, multiplier = 2),  // ì§€ìˆ˜ ë°±ì˜¤í”„
    dltTopicSuffix = ".dlt"                   // DLT í† í”½ìœ¼ë¡œ ì´ë™
)
```
- **ìë™ ì¬ì‹œë„**: ì‹¤íŒ¨ ì‹œ ìµœëŒ€ 5íšŒ ì¬ì‹œë„ (ì§€ìˆ˜ ë°±ì˜¤í”„: 1s â†’ 2s â†’ 4s â†’ 8s)
- **Dead Letter Topic**: ìµœì¢… ì‹¤íŒ¨ ë©”ì‹œì§€ë¥¼ ë³„ë„ í† í”½ìœ¼ë¡œ ê²©ë¦¬

### 3. ë³‘ë ¬ ì²˜ë¦¬
- **ë©€í‹° íŒŒí‹°ì…˜**: ê° í† í”½ë‹¹ 3ê°œì˜ íŒŒí‹°ì…˜
- **Concurrency**: Consumerë‹¹ 3ê°œì˜ ìŠ¤ë ˆë“œ ë™ì‹œ ì²˜ë¦¬
- **Round Robin ë¶„ë°°**: ê· ë“±í•œ ë¶€í•˜ ë¶„ì‚°

### 4. ë°ì´í„° ì˜ì†ì„±
- **ì´ë©”ì¼ ë°œì†¡ ì´ë ¥ ì €ì¥**: ê°ì‚¬(Audit) ë¡œê·¸ ê´€ë¦¬
- **ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬**: JPAë¥¼ í†µí•œ CRUD ì‘ì—…

---

## ğŸ”§ ì„œë¹„ìŠ¤ êµ¬ì„±

### 1ï¸âƒ£ User Service (Port: 8080)
**ì—­í• **: ì‚¬ìš©ì íšŒì›ê°€ì… ë° ì´ë²¤íŠ¸ ë°œí–‰

```
ğŸ“‚ ì£¼ìš” ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ UserController        - REST API ì—”ë“œí¬ì¸íŠ¸
â”œâ”€â”€ UserService           - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ + Kafka Producer
â”œâ”€â”€ UserRepository        - JPA ë¦¬í¬ì§€í† ë¦¬
â”œâ”€â”€ User (Entity)         - ì‚¬ìš©ì ì—”í‹°í‹°
â””â”€â”€ UserSignedUpEvent     - ì´ë²¤íŠ¸ ëª¨ë¸
```

**ê¸°ëŠ¥**:
- âœ… íšŒì›ê°€ì… API (`POST /api/users`)
- âœ… íšŒì› ì •ë³´ H2 DB ì €ì¥
- âœ… `user.signed-up` í† í”½ìœ¼ë¡œ ì´ë²¤íŠ¸ ë°œí–‰

**ì˜ì¡´ì„±**: Spring Web, Spring Data JPA, Spring Kafka, H2

---

### 2ï¸âƒ£ Email Service (Port: 8081)
**ì—­í• **: íšŒì›ê°€ì… ì´ë²¤íŠ¸ ì†Œë¹„ ë° í™˜ì˜ ì´ë©”ì¼ ë°œì†¡

```
ğŸ“‚ ì£¼ìš” ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ UserSignedUpEventConsumer     - Kafka Consumer
â”œâ”€â”€ UserSignedUpEventDltConsumer  - DLT ë©”ì‹œì§€ ì²˜ë¦¬
â”œâ”€â”€ EmailLogRepository            - ì´ë©”ì¼ ë¡œê·¸ ë¦¬í¬ì§€í† ë¦¬
â””â”€â”€ EmailLog (Entity)             - ì´ë©”ì¼ ë°œì†¡ ì´ë ¥ ì—”í‹°í‹°
```

**ê¸°ëŠ¥**:
- âœ… `user.signed-up` í† í”½ì—ì„œ ë©”ì‹œì§€ ìˆ˜ì‹ 
- âœ… í™˜ì˜ ì´ë©”ì¼ ë°œì†¡ (ì‹œë®¬ë ˆì´ì…˜)
- âœ… ë°œì†¡ ë‚´ì—­ DB ì €ì¥
- âœ… 3ê°œ íŒŒí‹°ì…˜ ë³‘ë ¬ ì²˜ë¦¬ (concurrency = 3)

**ì˜ì¡´ì„±**: Spring Web, Spring Data JPA, Spring Kafka, H2

---

### 3ï¸âƒ£ Email-Send-Producer
**ì—­í• **: ì´ë©”ì¼ ë°œì†¡ ìš”ì²­ì„ Kafkaë¡œ ì „ë‹¬

```
ğŸ“‚ ì£¼ìš” ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ EmailController       - REST API ì—”ë“œí¬ì¸íŠ¸
â”œâ”€â”€ EmailService          - Kafka Producer
â”œâ”€â”€ SendEmailRequestDto   - ìš”ì²­ DTO
â””â”€â”€ EmailSendMessage      - ë©”ì‹œì§€ ëª¨ë¸
```

**ê¸°ëŠ¥**:
- âœ… ì´ë©”ì¼ ë°œì†¡ API (`POST /api/emails`)
- âœ… `email.send` í† í”½ìœ¼ë¡œ ë©”ì‹œì§€ ë°œí–‰
- âœ… Round Robin íŒŒí‹°ì…˜ ë¶„ë°°

**ì˜ì¡´ì„±**: Spring Web, Spring Kafka

---

### 4ï¸âƒ£ Email-Send-Consumer (Port: Random)
**ì—­í• **: ì´ë©”ì¼ ë°œì†¡ ë©”ì‹œì§€ ì†Œë¹„ ë° ì²˜ë¦¬

```
ğŸ“‚ ì£¼ìš” ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ EmailSendConsumer     - Kafka Consumer
â”œâ”€â”€ EmailSendDltConsumer  - DLT ë©”ì‹œì§€ ì²˜ë¦¬
â””â”€â”€ EmailSendMessage      - ë©”ì‹œì§€ ëª¨ë¸
```

**ê¸°ëŠ¥**:
- âœ… `email.send` í† í”½ì—ì„œ ë©”ì‹œì§€ ìˆ˜ì‹ 
- âœ… ì´ë©”ì¼ ë°œì†¡ ì‹œë®¬ë ˆì´ì…˜ (3ì´ˆ ì§€ì—°)
- âœ… ìœ íš¨ì„± ê²€ì¦ ë° ì—ëŸ¬ í•¸ë“¤ë§
- âœ… ì¬ì‹œë„ ë° DLT ì²˜ë¦¬

**ì˜ì¡´ì„±**: Spring Web, Spring Kafka

---

## ğŸ“¡ API ëª…ì„¸

### User Service

#### íšŒì›ê°€ì…
```http
POST /api/users
Content-Type: application/json

{
  "email": "user@example.com",
  "name": "í™ê¸¸ë™",
  "password": "password123"
}

Response: 200 OK
"íšŒì›ê°€ì… ì„±ê³µ"
```

---

### Email-Send-Producer

#### ì´ë©”ì¼ ë°œì†¡ ìš”ì²­
```http
POST /api/emails
Content-Type: application/json

{
  "to": "recipient@example.com",
  "subject": "ì œëª©",
  "body": "ë³¸ë¬¸ ë‚´ìš©"
}

Response: 200 OK
"ì´ë©”ì¼ ë°œì†¡ ìš”ì²­ ì™„ë£Œ"
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
```bash
# Java 21 ì„¤ì¹˜ í™•ì¸
java -version

# Kafka í´ëŸ¬ìŠ¤í„° ì‹¤í–‰ (EC2 ë˜ëŠ” ë¡œì»¬)
# ë¸Œë¡œì»¤: 9092, 19092, 29092 í¬íŠ¸
```

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
ê° ì„œë¹„ìŠ¤ì˜ `application.yml`ì—ì„œ Kafka ë¸Œë¡œì»¤ ì£¼ì†Œ ì„¤ì •:
```yaml
spring:
  kafka:
    bootstrap-servers:
      - ${ec2_public_ip}:9092
      - ${ec2_public_ip}:19092
      - ${ec2_public_ip}:29092
```

### ì„œë¹„ìŠ¤ ì‹¤í–‰
```bash
# 1. User Service ì‹¤í–‰
cd user-service
./gradlew bootRun

# 2. Email Service ì‹¤í–‰
cd email-service
./gradlew bootRun

# 3. Email-Send-Producer ì‹¤í–‰
cd email-send-producer
./gradlew bootRun

# 4. Email-Send-Consumer ì‹¤í–‰
cd email-send-consumer
./gradlew bootRun
```

### ë¹Œë“œ
```bash
# ê° ì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ì—ì„œ
./gradlew clean build

# ìƒì„±ëœ JAR íŒŒì¼ ì‹¤í–‰
java -jar build/libs/*.jar
```

---

## ğŸ“ ê¸°ìˆ ì  êµ¬í˜„ í¬ì¸íŠ¸

### 1. Kafka Producer êµ¬ì„±
```java
// KafkaTemplateì„ í†µí•œ ë©”ì‹œì§€ ë°œí–‰
kafkaTemplate.send("user.signed-up", toJsonString(event));

// Round Robin íŒŒí‹°ì…”ë„ˆ ì„¤ì •
properties:
  partitioner.class: org.apache.kafka.clients.producer.RoundRobinPartitioner
```

### 2. Kafka Consumer êµ¬ì„±
```java
@KafkaListener(
    topics = "user.signed-up",
    groupId = "email-service",
    concurrency = "3"  // 3ê°œ ìŠ¤ë ˆë“œ ë³‘ë ¬ ì²˜ë¦¬
)
```

### 3. ì¥ì•  ë³µêµ¬ ì „ëµ
- **ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜**: `@RetryableTopic` ì–´ë…¸í…Œì´ì…˜ í™œìš©
- **ì§€ìˆ˜ ë°±ì˜¤í”„**: ì¬ì‹œë„ ê°„ê²©ì„ ì§€ìˆ˜ì ìœ¼ë¡œ ì¦ê°€ (1s â†’ 2s â†’ 4s â†’ 8s)
- **DLT ì²˜ë¦¬**: ìµœì¢… ì‹¤íŒ¨ ë©”ì‹œì§€ë¥¼ ë³„ë„ í† í”½ìœ¼ë¡œ ê²©ë¦¬í•˜ì—¬ ìˆ˜ë™ ì²˜ë¦¬ ê°€ëŠ¥

### 4. ì§ë ¬í™”/ì—­ì§ë ¬í™”
```java
// Producer: ê°ì²´ â†’ JSON â†’ Kafka
ObjectMapper.writeValueAsString(object)

// Consumer: Kafka â†’ JSON â†’ ê°ì²´
ObjectMapper.readValue(json, Class)
```

### 5. ë°ì´í„°ë² ì´ìŠ¤ ì „ëµ
- **ì¸ë©”ëª¨ë¦¬ DB**: ë¹ ë¥¸ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ H2 ì‚¬ìš©
- **ìë™ DDL**: Spring JPAì˜ ìë™ í…Œì´ë¸” ìƒì„±
- **ê²©ë¦¬ëœ DB**: ê° ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ì¸ DB ì†Œìœ 

### 6. ë©€í‹° íŒŒí‹°ì…˜ í™œìš©
- **ë¶€í•˜ ë¶„ì‚°**: 3ê°œ íŒŒí‹°ì…˜ìœ¼ë¡œ ë©”ì‹œì§€ ë¶„ì‚° ì²˜ë¦¬
- **ìˆœì„œ ë³´ì¥**: ë™ì¼ í‚¤ë¥¼ ê°€ì§„ ë©”ì‹œì§€ëŠ” ê°™ì€ íŒŒí‹°ì…˜ìœ¼ë¡œ ì „ë‹¬
- **ë³‘ë ¬ ì²˜ë¦¬**: Consumer Concurrency ì„¤ì •ìœ¼ë¡œ ì²˜ë¦¬ëŸ‰ ì¦ê°€

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ í¬ì¸íŠ¸

### Kafka ë©”íŠ¸ë¦­
- Consumer Lag ëª¨ë‹ˆí„°ë§
- íŒŒí‹°ì…˜ë³„ ì²˜ë¦¬ëŸ‰
- DLT í† í”½ ë©”ì‹œì§€ ìˆ˜

### ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”íŠ¸ë¦­
- API ì‘ë‹µ ì‹œê°„
- ì´ë©”ì¼ ë°œì†¡ ì„±ê³µë¥ 
- ì¬ì‹œë„ íšŸìˆ˜

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ

ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ë‹¤ìŒì„ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. âœ… **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ì„¤ê³„ ë° êµ¬í˜„**
2. âœ… **Apache Kafkaë¥¼ í™œìš©í•œ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì‹œìŠ¤í…œ**
3. âœ… **Producer/Consumer íŒ¨í„´ êµ¬í˜„**
4. âœ… **ë¹„ë™ê¸° ë©”ì‹œì§• ë° ë©”ì‹œì§€ í í™œìš©**
5. âœ… **ì¥ì•  ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜ (ì¬ì‹œë„, DLT)**
6. âœ… **Spring Boot ê¸°ë°˜ RESTful API ê°œë°œ**
7. âœ… **JPAë¥¼ í™œìš©í•œ ë°ì´í„° ì˜ì†ì„± ê´€ë¦¬**
8. âœ… **ë©€í‹° ìŠ¤ë ˆë“œ ë° ë³‘ë ¬ ì²˜ë¦¬**

---

## ğŸ“ ì¶”ê°€ ê°œì„  ì‚¬í•­ (í–¥í›„ ê³„íš)

- [ ] **ëª¨ë‹ˆí„°ë§**: Prometheus + Grafana ì—°ë™
- [ ] **ë¡œê¹…**: ELK Stack êµ¬ì„±
- [ ] **ë³´ì•ˆ**: Spring Security + JWT ì¸ì¦
- [ ] **í…ŒìŠ¤íŠ¸**: í†µí•© í…ŒìŠ¤íŠ¸ ë° E2E í…ŒìŠ¤íŠ¸ ì¶”ê°€
- [ ] **ë°°í¬**: Docker Compose ë° Kubernetes ë°°í¬
- [ ] **ì‹¤ì œ ì´ë©”ì¼ ë°œì†¡**: SMTP ì—°ë™ (Gmail, AWS SES)
- [ ] **ë©”ì‹œì§€ ê²€ì¦**: Schema Registry ë„ì… (Avro)
- [ ] **ë¶„ì‚° ì¶”ì **: Zipkin ë˜ëŠ” Jaeger ì—°ë™

---

## ğŸ‘¨â€ğŸ’» í”„ë¡œì íŠ¸ êµ¬ì¡°

```
workspace/
â”œâ”€â”€ user-service/              # ì‚¬ìš©ì ê´€ë¦¬ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ src/main/java/com/example/userservice/
â”‚   â”œâ”€â”€ src/main/resources/application.yml
â”‚   â””â”€â”€ build.gradle
â”œâ”€â”€ email-service/             # ì´ë©”ì¼ ë°œì†¡ ì„œë¹„ìŠ¤ (Consumer)
â”‚   â”œâ”€â”€ src/main/java/com/example/emailservice/
â”‚   â”œâ”€â”€ src/main/resources/application.yml
â”‚   â””â”€â”€ build.gradle
â”œâ”€â”€ email-send-producer/       # ì´ë©”ì¼ ë°œì†¡ ìš”ì²­ ì„œë¹„ìŠ¤ (Producer)
â”‚   â”œâ”€â”€ src/main/java/com/example/emailsendproducer/
â”‚   â”œâ”€â”€ src/main/resources/application.yml
â”‚   â””â”€â”€ build.gradle
â”œâ”€â”€ email-send-consumer/       # ì´ë©”ì¼ ë°œì†¡ ì²˜ë¦¬ ì„œë¹„ìŠ¤ (Consumer)
â”‚   â”œâ”€â”€ src/main/java/com/example/emailsendconsumer/
â”‚   â”œâ”€â”€ src/main/resources/application.yml
â”‚   â””â”€â”€ build.gradle
â””â”€â”€ README.md                  # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

---

## ğŸ¤ ê¸°ì—¬

ì´ í”„ë¡œì íŠ¸ëŠ” í•™ìŠµ ëª©ì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ê°œì„  ì‚¬í•­ì´ë‚˜ ë²„ê·¸ê°€ ìˆë‹¤ë©´ ì´ìŠˆë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.

---

## ğŸ“œ ë¼ì´ì„¼ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” êµìœ¡ ëª©ì ìœ¼ë¡œ ììœ ë¡­ê²Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

<div align="center">
  <strong>Built with â¤ï¸ using Spring Boot & Apache Kafka</strong>
</div>
